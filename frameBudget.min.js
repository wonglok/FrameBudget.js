/*
@preserve
    Author: WONG LOK
    Github: wonglok
    License: Apache v2
*/
/*
@preserve
requestAnimationFrame Polyfill
    http://paulirish.com/2011/requestanimationframe-for-smart-animating/
    http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
    requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel
    MIT license

ArrayFilter:
    Credit: MDN (Mozilla Developer Network)

Consle Polyfill:
    HTML5 Boilerplat
*/
!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}(),function(a){"use strict";function b(){function b(a){a&&(H?console.log("You are using estimator"):(a>1e3/60&&(console.warn("***** You are might be specifying too much frame budget: "+a+"ms"),a=1e3/60),J=a))}function c(){function b(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function c(a,b,c){return!0&&a<Math.max.apply(null,c)&&a>Math.min.apply(null,c)}function d(a,b){for(var d=0;b>=d;d++)a=a.filter(c);return a}function e(){j=d(j,L);var a=b(j);return P&&console.info(j),a}function f(){h=a.performance.now(),requestAnimationFrame(function(){if(i=a.performance.now(),j.push(i-h),j.length<=K)requestAnimationFrame(f);else{var b=e();g(b)}})}function g(a){N=!0,J=a*M,P&&console.debug({frameBudget:a,afterCalc:J}),v()}var h,i,j=[];f()}function d(){DEBUG.ENABLED=!DEBUG.ENABLED}function e(){return P&&S>D&&(Q.i=D,Q.frame="Start",Q.budget=J,console.log(Q)),0}function f(a){return P&&a++,a}function g(a){P&&S>D&&(R.i=D,R.frame="Ended",R.renderer=E,R.taskDone=a,console.log(R))}function h(){return C.shift()}function i(a){return"undefined"!=typeof a&&"function"==typeof a.process}function j(a){"undefined"!=typeof a.args?a.process.apply(a.ctx,a.args):a.process.call(a.ctx,a.data)}function k(){var b,c,d=a.performance.now(),k=e();E&&G.fn.apply(G.ctx,G.args);do b=h(),c=i(b),c&&(j(b),k=f(k));while(a.performance.now()-d<J&&C.length>0);g(k),q()}function l(a){D=requestAnimationFrame(a)}function m(){l(m),k()}function n(){l(m),P&&console.info("~~RAF Loop Started")}function o(){B=!1,cancelAnimationFrame(D),P&&console.info("**RAF Loop Stopped")}function p(){B||(B=!0,n())}function q(){0!==C.length||E||o()}function r(a){C.push(a),a.skipAutoStart||p()}function s(){C.length>0&&p()}function t(a){"undefined"!=typeof a&&("function"==typeof a.fn&&(G.fn=a.fn,E=!0),"undefined"!=typeof a.ctx&&(G.ctx=a.ctx),"undefined"!=typeof a.args&&(G.args=a.args))}function u(a,b){var c=O[a];if(c)for(var d=0;d<c.length;d++)b.apply(this,c[d]);O[a]=null}function v(){u("addTask",r),u("digest",s)}function w(a,b,c){N?b.apply(this,c):(O[a]||(O[a]=[]),O[a].push(c))}function x(){w("addTask",r,arguments)}function y(){w("digest",s,arguments)}function z(a){var b=a[0];"undefined"==typeof b||("undefined"!=typeof b.renderer&&(t(b.renderer),H=!0),"undefined"!=typeof b.noDebug&&b.noDebug===!1&&(P=!1)),H?(N=!1,c()):N=!0}var A=this,B=(function(){return!this}(),!1),C=[],D=0,E=!1,F=function(){},G={ctx:null,fn:F,args:[]},H=!1,I=5,J=parseInt(I,10),K=15,L=2,M=.75,N=!1,O={addTask:null,digest:null},P=!0,Q={},R={},S=100;return z(arguments),A.addTask=x,A.digest=y,A.toggleDebug=d,A.setFrameBudget=b,A.stopLoop=o,this}a.FrameBudgetTaskManager=b}(this);